{% extends "layouts/base.html" %}
{% import "macros/analytics_data.html" as analytics_macro %}
{% import "macros/picture.html" as img %}

{% block body_data %}{{ analytics_macro::body_attrs(analytics=analytics) }}{% endblock %}

{% block title %}Blog - Naked Pineapple{% endblock %}

{% block description %}Skincare tips, self-care rituals, and stories from the Naked Pineapple community. Discover the power of pineapple for radiant skin.{% endblock %}

{% block content %}
{# Hero Section #}
<section class="relative py-20 md:py-28 bg-gradient-to-br from-sand/50 via-cream to-honey/10 overflow-hidden">
    {# Decorative elements #}
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
        <div class="absolute -top-24 -right-24 w-96 h-96 rounded-full bg-primary/5 blur-3xl"></div>
        <div class="absolute -bottom-24 -left-24 w-80 h-80 rounded-full bg-honey/10 blur-3xl"></div>
    </div>

    {# Subtle pattern #}
    <div class="absolute inset-0 opacity-[0.03]" style="background-image: radial-gradient(circle at 2px 2px, currentColor 1px, transparent 0); background-size: 24px 24px;"></div>

    <div class="page-width relative">
        <div class="max-w-3xl mx-auto text-center">
            <span class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-primary/10 text-primary text-sm font-medium mb-6 animate-fade-down">
                <i class="ph ph-newspaper text-lg"></i>
                The Naked Pineapple Blog
            </span>

            <h1 class="font-display text-4xl md:text-5xl lg:text-6xl font-medium text-foreground mb-6 leading-[1.1] animate-fade-up">
                Glow From <span class="text-primary">Within</span>
            </h1>

            <p class="text-lg md:text-xl text-muted-foreground max-w-2xl mx-auto animate-fade-up animation-delay-100">
                Skincare wisdom, self-care rituals, and stories of radiance. Your guide to confident, glowing skin.
            </p>
        </div>
    </div>
</section>

{# Blog Posts Grid #}
<section class="py-16 md:py-24 bg-background">
    <div class="page-width">
        {% if posts.is_empty() %}
        {# Empty state #}
        <div class="max-w-md mx-auto text-center py-16">
            <div class="w-20 h-20 rounded-full bg-sand flex items-center justify-center mx-auto mb-6">
                <i class="ph ph-pencil-simple text-3xl text-muted-foreground"></i>
            </div>
            <h2 class="font-display text-2xl text-foreground mb-4">Coming Soon</h2>
            <p class="text-muted-foreground">
                We're working on some amazing content for you. Check back soon for skincare tips, self-care rituals, and more!
            </p>
        </div>
        {% else %}
        {# Featured Post (first post) #}
        {% if let Some(featured) = posts.first() %}
        <div class="mb-16">
            <a href="/blog/{{ featured.slug }}" class="group block">
                <article class="grid lg:grid-cols-2 gap-8 lg:gap-12 items-center bg-card rounded-3xl shadow-sm border border-border-light overflow-hidden hover:shadow-xl hover:border-primary/20 transition-all duration-300">
                    {# Featured Image #}
                    <div class="relative aspect-[4/3] lg:aspect-auto lg:h-full overflow-hidden">
                        {% if let Some(image) = featured.featured_image.as_ref() %}
                        {{ img::picture(path=image, alt=featured.title, sizes="(max-width: 1024px) 100vw, 50vw", class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500", loading="eager") }}
                        {% else %}
                        <div class="w-full h-full bg-gradient-to-br from-primary/20 via-honey/20 to-terracotta/20 flex items-center justify-center">
                            <i class="ph ph-article text-6xl text-primary/40"></i>
                        </div>
                        {% endif %}
                        <div class="absolute top-4 left-4">
                            <span class="px-3 py-1.5 bg-primary text-white text-xs font-semibold rounded-full uppercase tracking-wider">
                                Featured
                            </span>
                        </div>
                    </div>

                    {# Content #}
                    <div class="p-8 lg:p-12">
                        {# Tags #}
                        {% if !featured.tags.is_empty() %}
                        <div class="flex flex-wrap gap-2 mb-4">
                            {% for tag in featured.tags.iter().take(3) %}
                            <span class="px-2 py-1 bg-sand text-muted-foreground text-xs font-medium rounded-full">{{ tag }}</span>
                            {% endfor %}
                        </div>
                        {% endif %}

                        <h2 class="font-display text-2xl md:text-3xl lg:text-4xl text-foreground mb-4 group-hover:text-primary transition-colors leading-tight">
                            {{ featured.title }}
                        </h2>

                        {% if let Some(desc) = featured.description.as_ref() %}
                        <p class="text-muted-foreground text-lg mb-6 line-clamp-3">{{ desc }}</p>
                        {% endif %}

                        <div class="flex items-center gap-4 text-sm text-muted-foreground">
                            <span class="flex items-center gap-1.5">
                                <i class="ph ph-calendar-blank"></i>
                                {{ featured.published_at.format("%B %d, %Y") }}
                            </span>
                            <span class="flex items-center gap-1.5">
                                <i class="ph ph-clock"></i>
                                {{ featured.reading_time_minutes }} min read
                            </span>
                        </div>
                    </div>
                </article>
            </a>
        </div>
        {% endif %}

        {# Rest of posts #}
        {% if posts.len() > 1 %}
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
            {% for post in posts.iter().skip(1) %}
            <a href="/blog/{{ post.slug }}" class="group">
                <article class="bg-card rounded-2xl shadow-sm border border-border-light overflow-hidden hover:shadow-lg hover:border-primary/20 transition-all duration-300 h-full flex flex-col">
                    {# Image #}
                    <div class="relative aspect-[16/10] overflow-hidden">
                        {% if let Some(image) = post.featured_image.as_ref() %}
                        {{ img::picture(path=image, alt=post.title, sizes="(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 33vw", class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500") }}
                        {% else %}
                        <div class="w-full h-full bg-gradient-to-br from-sand via-cream to-honey/30 flex items-center justify-center">
                            <i class="ph ph-article text-4xl text-primary/30"></i>
                        </div>
                        {% endif %}
                    </div>

                    {# Content #}
                    <div class="p-6 flex flex-col flex-grow">
                        {# Tags #}
                        {% if !post.tags.is_empty() %}
                        <div class="flex flex-wrap gap-1.5 mb-3">
                            {% for tag in post.tags.iter().take(2) %}
                            <span class="px-2 py-0.5 bg-sand text-muted-foreground text-xs font-medium rounded-full">{{ tag }}</span>
                            {% endfor %}
                        </div>
                        {% endif %}

                        <h3 class="font-display text-xl text-foreground mb-3 group-hover:text-primary transition-colors leading-snug line-clamp-2">
                            {{ post.title }}
                        </h3>

                        {% if let Some(desc) = post.description.as_ref() %}
                        <p class="text-muted-foreground text-sm mb-4 line-clamp-2 flex-grow">{{ desc }}</p>
                        {% endif %}

                        <div class="flex items-center justify-between text-xs text-muted-foreground mt-auto pt-4 border-t border-border-light">
                            <span class="flex items-center gap-1.5">
                                <i class="ph ph-calendar-blank"></i>
                                {{ post.published_at.format("%b %d, %Y") }}
                            </span>
                            <span class="flex items-center gap-1.5">
                                <i class="ph ph-clock"></i>
                                {{ post.reading_time_minutes }} min
                            </span>
                        </div>
                    </div>
                </article>
            </a>
            {% endfor %}
        </div>
        {% endif %}
        {% endif %}
    </div>
</section>

{# Newsletter CTA #}
<section class="py-16 md:py-20 bg-gradient-to-r from-primary via-terracotta to-honey relative overflow-hidden">
    {# Pattern overlay #}
    <div class="absolute inset-0 opacity-10" style="background-image: url('data:image/svg+xml,<svg width=&quot;20&quot; height=&quot;20&quot; viewBox=&quot;0 0 20 20&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;><circle cx=&quot;10&quot; cy=&quot;10&quot; r=&quot;1.5&quot; fill=&quot;white&quot;/></svg>'); background-size: 20px 20px;"></div>

    <div class="page-width relative">
        <div class="max-w-2xl mx-auto text-center">
            <h2 class="font-display text-3xl md:text-4xl text-white mb-4">
                Never Miss a Glow Tip
            </h2>
            <p class="text-white/80 text-lg mb-8">
                Subscribe to get skincare wisdom, exclusive offers, and first access to new products delivered to your inbox.
            </p>
            <form action="/newsletter/subscribe" method="post" class="flex flex-col sm:flex-row gap-3 max-w-md mx-auto">
                <input type="email"
                       name="email"
                       placeholder="Your email address"
                       required
                       class="flex-1 px-5 py-3.5 rounded-full bg-white/10 backdrop-blur-sm border border-white/20 text-white placeholder:text-white/60 focus:outline-none focus:bg-white/20 focus:border-white/40 transition-all">
                <button type="submit" class="px-8 py-3.5 bg-white text-primary font-semibold rounded-full hover:bg-cream transition-colors">
                    Subscribe
                </button>
            </form>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<style>
@keyframes fade-up {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes fade-down {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
}

.animate-fade-up {
    animation: fade-up 0.6s ease-out forwards;
}

.animate-fade-down {
    animation: fade-down 0.6s ease-out forwards;
}

.animation-delay-100 { animation-delay: 100ms; }

.line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}
</style>
{% endblock %}
