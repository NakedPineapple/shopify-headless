{#
    Enhanced Customer Card Partial

    Variables:
    - order: OrderDetailView with customer fields
#}

<div class="bg-card rounded-xl border border-border p-6">
    <h3 class="text-lg font-semibold text-foreground mb-4">Customer</h3>
    <div class="space-y-4">
        <div class="flex items-start justify-between">
            <div class="space-y-1">
                {% if let Some(cid) = order.customer_id %}
                <a href="/customers/{{ cid }}" class="font-medium text-foreground hover:text-primary">
                    {{ order.customer_name }}
                </a>
                {% else %}
                <p class="font-medium text-foreground">{{ order.customer_name }}</p>
                {% endif %}

                {% if let Some(email) = order.customer_email %}
                <p class="text-sm text-muted-foreground">
                    <a href="mailto:{{ email }}" class="hover:text-primary">{{ email }}</a>
                </p>
                {% endif %}

                {% if let Some(phone) = order.customer_phone %}
                <p class="text-sm text-muted-foreground">{{ phone }}</p>
                {% endif %}
            </div>

            {% if order.email_marketing %}
            <span class="text-xs text-success">
                <i class="ph ph-envelope"></i> Subscribed
            </span>
            {% endif %}
        </div>

        <!-- Customer Metrics -->
        {% if order.customer_id.is_some() %}
        <div class="pt-4 border-t border-border grid grid-cols-2 gap-4 text-sm">
            <div>
                <p class="text-muted-foreground">Orders</p>
                <p class="font-medium text-foreground">{{ order.orders_count }}</p>
            </div>
            <div>
                <p class="text-muted-foreground">Total spent</p>
                <p class="font-medium text-foreground">{{ order.total_spent }}</p>
            </div>
        </div>
        {% endif %}

        {% if let Some(note) = order.customer_note %}
        <div class="pt-4 border-t border-border">
            <p class="text-xs text-muted-foreground mb-1">Note</p>
            <p class="text-sm text-foreground">{{ note }}</p>
        </div>
        {% endif %}
    </div>
</div>
