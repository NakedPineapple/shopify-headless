{# Code management section for code discounts #}
{# Required variables: discount (DiscountTableView) #}
{% if discount.method == "Code" %}
<div class="bg-card rounded-xl border border-border p-6">
    <div class="flex items-center justify-between mb-4">
        <h2 class="text-lg font-semibold text-foreground">Discount Codes</h2>
        <button type="button"
                hx-get="/discounts/{{ discount.id|extract_id }}/codes/new"
                hx-target="#codes-modal"
                hx-swap="innerHTML"
                class="inline-flex items-center gap-2 px-3 py-1.5 text-sm text-primary hover:text-primary/80 transition-colors">
            <i class="ph ph-plus"></i>
            Add Codes
        </button>
    </div>

    {% if discount.code.is_some() %}
    <div class="space-y-2">
        <div class="flex items-center justify-between p-3 bg-muted rounded-lg">
            <div class="flex items-center gap-3">
                <i class="ph ph-ticket text-muted-foreground"></i>
                <code class="font-mono text-sm text-foreground">{{ discount.code.as_deref().unwrap_or("") }}</code>
            </div>
            <button type="button"
                    onclick="navigator.clipboard.writeText('{{ discount.code.as_deref().unwrap_or("") }}')"
                    class="text-sm text-muted-foreground hover:text-foreground transition-colors">
                <i class="ph ph-copy"></i>
            </button>
        </div>
    </div>
    {% endif %}

    {% if discount.code_count > 1 %}
    <p class="mt-3 text-sm text-muted-foreground">
        {{ discount.code_count }} codes total
    </p>
    {% endif %}
</div>

<div id="codes-modal"></div>
{% endif %}
